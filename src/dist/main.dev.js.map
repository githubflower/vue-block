{"version":3,"sources":["main.js"],"names":["Vue","use","Element","size","zIndex","prototype","axios","config","productionTip","window","stateManage","genId","_id","type","Date","store","debug","statenameIndex","stateData","threadAry","name","width","height","stateAry","stateId","stateType","inputAry","outputAry","children","x","y","lineAry","addThread","obj","push","getDefaultStateCfg","data","addState","state","index","addLine","threadIndex","lineData","relateLine2startState","relateLine2endState","deleteLine","lineItem","line","i","length","lineId","splice","startState","find","item","forEach","endState","stateIndex","resizeThread","dh","dw","EventObj","el","router","components","App","template"],"mappings":"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","sourcesContent":["// The Vue build version to load with the `import` command\r\n// (runtime-only or standalone) has been set in webpack.base.conf with an alias.\r\nimport Vue from 'vue'\r\nimport App from './App'\r\nimport router from './router'\r\nimport Element from 'element-ui';\r\nimport 'element-ui/lib/theme-chalk/index.css';\r\nimport axios from 'axios';\r\n\r\n\r\nVue.use(Element, { size: 'small', zIndex: 3000 });\r\nVue.prototype.axios = axios;\r\n\r\nVue.config.productionTip = false\r\n\r\nwindow.stateManage = {};//状态管理  后续采用vuex实现 TODO\r\nwindow.genId = (function () {\r\n  var _id = 0;\r\n  return function (type) {\r\n    return type + '-' + +new Date();//+ ++_id\r\n  }\r\n})();\r\n\r\nwindow.store = {\r\n  debug: true,\r\n  statenameIndex: 0,\r\n  stateData: {\r\n    threadAry: [\r\n      {\r\n        name: \"线程1\",\r\n        width: 1600,\r\n        height: 500,\r\n        stateAry: [\r\n          {\r\n            stateId: \"custom-state-id\",\r\n            stateType: \"stateDiv\",\r\n            name: \"默认状态名称1\",\r\n            inputAry: [],\r\n            outputAry: [],\r\n            children: [],\r\n            x: 5,\r\n            y: 0,\r\n          },\r\n          {\r\n            width: \"302px\",\r\n            height: \"122px\",\r\n            name: \"状态描述99\",\r\n            stateType: \"loopDiv\",\r\n            stateId: window.genId(\"state\"),\r\n            inputAry: [],\r\n            outputAry: [],\r\n            x: 200,\r\n            y: 100,\r\n            children: [\r\n              {\r\n                name: \"child1\",\r\n                stateId: \"state-child1\",\r\n                stateType: \"stateDiv\",\r\n                inputAry: [],\r\n                outputAry: [],\r\n                x: 50,\r\n                y: 50,\r\n              },\r\n            ],\r\n          },\r\n        ],\r\n        lineAry: [],\r\n      },\r\n\r\n    ],\r\n  },\r\n  addThread(obj) {\r\n    this.stateData.threadAry.push(obj);\r\n  },\r\n  /**\r\n  * 获取状态组件的默认配置\r\n  * @param {index: this.threadIndex, x: e.x - threadPosInfo.x, y: e.y - threadPosInfo.y, stateType: e.dataTransfer.getData(\"stateType\")} data\r\n  */\r\n  getDefaultStateCfg(data) {\r\n    return {\r\n      width: data.stateType === \"loopDiv\" ? \"300px\" : \"76px\",\r\n      height: data.stateType === \"loopDiv\" ? \"120px\" : \"40px\",\r\n      name: \"状态描述\" + this.statenameIndex++,\r\n      stateType: data.stateType,\r\n      stateId: window.genId(\"state\"),\r\n      inputAry: [],\r\n      outputAry: [],\r\n      x: data.x,\r\n      y: data.y,\r\n      children:\r\n        data.stateType === \"loopDiv\"\r\n          ? [\r\n            {\r\n              name: \"child1\",\r\n              stateId: \"state-child1\",\r\n              // stateType: \"loopBlock\",\r\n              inputAry: [],\r\n              outputAry: [],\r\n              x: 50,\r\n              y: 50,\r\n            },\r\n          ]\r\n          : [],\r\n    }\r\n  },\r\n  addState(data) {\r\n    let state = this.getDefaultStateCfg(data);\r\n    this.stateData.threadAry[data.index].stateAry.push(state);\r\n  },\r\n  /**\r\n   * 在线程框内增加连线\r\n   * @param { threadIndex, lineData }data\r\n   */\r\n  addLine(data) {\r\n    this.stateData.threadAry[data.threadIndex].lineAry.push(data.lineData);\r\n    //将连线数据添加到首尾2个状态块\r\n    this.relateLine2startState(data);\r\n    this.relateLine2endState(data);\r\n  },\r\n  /**\r\n   * 删除连线 \r\n   * 参数：连线id， 线程索引（TODO:后续考虑修改为线程id）\r\n   * @param {lineId, threadIndex} data\r\n   */\r\n  deleteLine(data) {\r\n    let lineAry = this.stateData.threadAry[data.threadIndex].lineAry,\r\n      lineItem,\r\n      line,\r\n      i;\r\n    for (i = 0; i < lineAry.length; i++) {\r\n      lineItem = lineAry[i];\r\n      if (lineItem.lineId === data.lineId) {\r\n        line = lineAry.splice(i, 1)[0];\r\n        break;\r\n      }\r\n    }\r\n    //更新这条线的始末状态的outputAry inputAry信息\r\n    let stateAry = this.stateData.threadAry[data.threadIndex].stateAry;\r\n    let startState = stateAry.find((item) => {\r\n      return item.stateId === line.startState.stateId;\r\n    });\r\n    let outputAry = startState.outputAry;\r\n    outputAry.forEach((item, index) => {\r\n      if (item.lineId === line.lineId) {\r\n        outputAry.splice(index, 1);\r\n        return false;\r\n      }\r\n    });\r\n\r\n    let endState = stateAry.find((item) => {\r\n      return item.stateId === line.endState.stateId;\r\n    });\r\n    let inputAry = endState.inputAry;\r\n    inputAry.forEach((item, index) => {\r\n      if (item.lineId === line.lineId) {\r\n        inputAry.splice(index, 1);\r\n        return false;\r\n      }\r\n    });\r\n  },\r\n  /**\r\n   * 将连线数据和连线的首尾2个状态关联\r\n   * @param  { threadIndex, lineData }data\r\n   */\r\n  relateLine2startState(data) {\r\n    if (data.lineData.startState) {\r\n      let outputAry = this.stateData.threadAry[data.threadIndex].stateAry[\r\n        data.lineData.startState.stateIndex\r\n      ].outputAry;\r\n      if (!outputAry) {\r\n        outputAry = [];\r\n        this.stateData.threadAry[data.threadIndex].stateAry[\r\n          data.lineData.startState.stateIndex\r\n        ].outputAry = outputAry;\r\n      }\r\n      outputAry.push({\r\n        lineId: data.lineData.lineId, //这里只存放连线的lineId，对连线的具体数据只保存一份，放在thread.lineAry里面，避免维护多份数据\r\n      });\r\n    }\r\n  },\r\n  relateLine2endState(data) {\r\n    if (\r\n      data.lineData.endState &&\r\n      data.lineData.endState.stateIndex !== null\r\n    ) {\r\n      let inputAry = this.stateData.threadAry[data.threadIndex].stateAry[\r\n        data.lineData.endState.stateIndex\r\n      ].inputAry;\r\n      if (!inputAry) {\r\n        inputAry = [];\r\n        this.stateData.threadAry[data.threadIndex].stateAry[\r\n          data.lineData.endState.stateIndex\r\n        ].inputAry = inputAry;\r\n      }\r\n      inputAry.push({\r\n        lineId: data.lineData.lineId,\r\n      });\r\n    }\r\n  },\r\n  /**\r\n   * 调整线程框的宽高\r\n   * @param {dw, dh} data \r\n   */\r\n  resizeThread(data) {\r\n    if (data.dh) {\r\n      this.stateData.threadAry[data.threadIndex].height += data.dh;\r\n    }\r\n    if (data.dw) {\r\n      this.stateData.threadAry[data.threadIndex].width += data.dw;\r\n    }\r\n  },\r\n}\r\n\r\n\r\n/* eslint-disable no-new */\r\nwindow.EventObj = new Vue();\r\nnew Vue({\r\n  el: '#app',\r\n  router,\r\n  components: { App },\r\n  template: '<App/>'\r\n})\r\n"],"file":"main.dev.js"}