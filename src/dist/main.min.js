"use strict";var _vue=_interopRequireDefault(require("vue")),_App=_interopRequireDefault(require("./App")),_router=_interopRequireDefault(require("./router")),_elementUi=_interopRequireDefault(require("element-ui"));require("element-ui/lib/theme-chalk/index.css");var _axios=_interopRequireDefault(require("axios"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}_vue.default.use(_elementUi.default,{size:"small",zIndex:3e3}),_vue.default.prototype.axios=_axios.default,_vue.default.config.productionTip=!1,window.stateManage={},window.genId=function(e){return e+"-"+ +new Date};var STATE_NAME_POOL=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];window.store={debug:!0,statenameIndex:0,stateData:{threadAry:[{name:"Main_thread",width:1200,height:500,stateAry:[],lineAry:[]}],lineMap:[]},addThread:function(e){this.stateData.threadAry.push(e)},getDefaultStateCfg:function(e){return{width:"loopDiv"===e.stateType?"300px":"76px",height:"loopDiv"===e.stateType?"120px":"40px",name:STATE_NAME_POOL[this.statenameIndex++],stateType:e.stateType,stateId:window.genId("state"),inputAry:[],outputAry:[],parent:null,mode:"normal",x:e.x,y:e.y,children:[]}},addState:function(e){var t=this.getDefaultStateCfg(e);this.stateData.threadAry[e.index].stateAry.push(t)},addLine:function(e){this.stateData.threadAry[e.threadIndex].lineAry.push(e.lineData),this.relateLine2startState(e),this.relateLine2endState(e)},deleteLine:function(e){var a,t,n=this.stateData.threadAry[e.threadIndex].lineAry;for(t=0;t<n.length;t++)if(n[t].lineId===e.lineId){a=n.splice(t,1)[0];break}var r=store.getState(e.threadIndex,a.startState.stateId).outputAry;r.forEach(function(e,t){if(e.lineId===a.lineId)return r.splice(t,1),!1});var i=store.getState(e.threadIndex,a.endState.stateId).inputAry;i.forEach(function(e,t){if(e.lineId===a.lineId)return i.splice(t,1),!1})},relateLine2startState:function(e){var t=e.lineData.startState.stateId;if(e.lineData.startState){var a=store.getState(e.threadIndex,t).outputAry;(a=a||[]).push({lineId:e.lineData.lineId})}},relateLine2endState:function(e){if(e.lineData.endState&&null!==e.lineData.endState.stateIndex){var t=e.lineData.endState.stateId,a=store.getState(e.threadIndex,t).inputAry;(a=a||[]).push({lineId:e.lineData.lineId})}},resizeThread:function(e){e.dh&&(this.stateData.threadAry[e.threadIndex].height+=e.dh),e.dw&&(this.stateData.threadAry[e.threadIndex].width+=e.dw)},getState:function(t,e,a){var n,r;return(r=a?this.stateData.threadAry.find(function(e){return e.id===t}):this.stateData.threadAry[t])&&(n=this.getStateImplement(e,r.stateAry)),n||console.error("根据threadIdOrIndex和stateId获取状态失败---\x3e threadId: "+t+" stateId: "+e+" isThreadId: "+a),n},getStateImplement:function(a,e){var n,r=this;return e.every(function(e){var t=!0;return e.stateId===a?(n=e,t=!1):e.children&&e.children.length&&(n=r.getStateImplement(a,e.children))&&(t=!1),t}),n}},_router.default.beforeEach(function(e,t,a){console.log(e),("blockly"===t.name&&"state"===e.name||"blockly"===e.name&&"state"===t.name)&&console.log("同步数据... "),a()}),window.EventObj=new _vue.default,new _vue.default({el:"#app",router:_router.default,components:{App:_App.default},template:"<App/>"});
//# sourceMappingURL=main.min.js.map
