"use strict";var _vue=_interopRequireDefault(require("vue")),_App=_interopRequireDefault(require("./App")),_router=_interopRequireDefault(require("./router")),_elementUi=_interopRequireDefault(require("element-ui"));require("element-ui/lib/theme-chalk/index.css");var _axios=_interopRequireDefault(require("axios"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}_vue.default.use(_elementUi.default,{size:"small",zIndex:3e3}),_vue.default.prototype.axios=_axios.default,_vue.default.config.productionTip=!1,window.stateManage={},window.genId=function(e){return e+"-"+ +new Date};var STATE_NAME_POOL=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];window.store={debug:!0,statenameIndex:0,stateData:{threadAry:[{name:"Main_thread",width:1200,height:500,stateAry:[],lineAry:[]}]},addThread:function(e){this.stateData.threadAry.push(e)},getDefaultStateCfg:function(e){return{width:"loopDiv"===e.stateType?"300px":"76px",height:"loopDiv"===e.stateType?"120px":"40px",name:STATE_NAME_POOL[this.statenameIndex++],stateType:e.stateType,stateId:window.genId("state"),inputAry:[],outputAry:[],parent:null,mode:"normal",x:e.x,y:e.y,children:[]}},addState:function(e){var t=this.getDefaultStateCfg(e);this.stateData.threadAry[e.index].stateAry.push(t)},addLine:function(e){this.stateData.threadAry[e.threadIndex].lineAry.push(e.lineData),this.relateLine2startState(e),this.relateLine2endState(e)},deleteLine:function(e){var a,t,n=this.stateData.threadAry[e.threadIndex].lineAry;for(t=0;t<n.length;t++)if(n[t].lineId===e.lineId){a=n.splice(t,1)[0];break}function r(e,t){for(var a in e){if(e[a].stateId===t.stateId)return void i.push(e[a]);r(e[a].children,t)}}var i=[],d=this.stateData.threadAry[e.threadIndex].stateAry;r(d,a.startState);var u=i.pop().outputAry;u.forEach(function(e,t){if(e.lineId===a.lineId)return u.splice(t,1),!1}),r(d,a.endState);var l=i.pop().inputAry;l.forEach(function(e,t){if(e.lineId===a.lineId)return l.splice(t,1),!1})},relateLine2startState:function(n){var r=[];if(n.lineData.startState){!function e(t){for(var a in t){if(t[a].stateId===n.lineData.startState.stateId)return void r.push(t[a]);e(t[a].children)}}(this.stateData.threadAry[n.threadIndex].stateAry);var e=r[0].outputAry;e||(e=[],r[0].outputAry=e),e.push({lineId:n.lineData.lineId})}},relateLine2endState:function(n){if(n.lineData.endState&&null!==n.lineData.endState.stateIndex){var r=[];!function e(t){for(var a in t){if(t[a].stateId===n.lineData.endState.stateId)return void r.push(t[a]);e(t[a].children)}}(this.stateData.threadAry[n.threadIndex].stateAry);var e=r[0].inputAry;e||(e=[],r[0].inputAry=e),e.push({lineId:n.lineData.lineId})}},resizeThread:function(e){e.dh&&(this.stateData.threadAry[e.threadIndex].height+=e.dh),e.dw&&(this.stateData.threadAry[e.threadIndex].width+=e.dw)}},_router.default.beforeEach(function(e,t,a){console.log(e),("blockly"===t.name&&"state"===e.name||"blockly"===e.name&&"state"===t.name)&&console.log("同步数据... "),a()}),window.EventObj=new _vue.default,new _vue.default({el:"#app",router:_router.default,components:{App:_App.default},template:"<App/>"});
//# sourceMappingURL=main.min.js.map
