"use strict";var _vue=_interopRequireDefault(require("vue")),_App=_interopRequireDefault(require("./App")),_router=_interopRequireDefault(require("./router")),_elementUi=_interopRequireDefault(require("element-ui"));require("element-ui/lib/theme-chalk/index.css");var _axios=_interopRequireDefault(require("axios"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}_vue.default.use(_elementUi.default,{size:"small",zIndex:3e3}),_vue.default.prototype.axios=_axios.default,_vue.default.config.productionTip=!1,window.stateManage={},window.genId=function(e){return e+"-"+ +new Date};var STATE_NAME_POOL=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];window.store={debug:!0,statenameIndex:0,stateData:{threadAry:[{name:"Main_thread",width:1200,height:500,stateAry:[],lineAry:[]}]},addThread:function(e){this.stateData.threadAry.push(e)},getDefaultStateCfg:function(e){return{width:"loopDiv"===e.stateType?"300px":"76px",height:"loopDiv"===e.stateType?"120px":"40px",name:STATE_NAME_POOL[this.statenameIndex++],stateType:e.stateType,stateId:window.genId("state"),inputAry:[],outputAry:[],parent:null,mode:"normal",x:e.x,y:e.y,children:[]}},addState:function(e){var t=this.getDefaultStateCfg(e);this.stateData.threadAry[e.index].stateAry.push(t)},addLine:function(e){this.stateData.threadAry[e.threadIndex].lineAry.push(e.lineData),this.relateLine2startState(e),this.relateLine2endState(e)},deleteLine:function(e){var a,t,r=this.stateData.threadAry[e.threadIndex].lineAry;for(t=0;t<r.length;t++)if(r[t].lineId===e.lineId){a=r.splice(t,1)[0];break}function n(e,t){for(var a in e){if(e[a].stateId===t.stateId)return void i.push(e[a]);n(e[a].children,t)}}var i=[],d=this.stateData.threadAry[e.threadIndex].stateAry;n(d,a.startState);var u=i.pop().outputAry;u.forEach(function(e,t){if(e.lineId===a.lineId)return u.splice(t,1),!1}),n(d,a.endState);var s=i.pop().inputAry;s.forEach(function(e,t){if(e.lineId===a.lineId)return s.splice(t,1),!1})},relateLine2startState:function(r){var n=[];if(r.lineData.startState){!function e(t){for(var a in t){if(t[a].stateId===r.lineData.startState.stateId)return void n.push(t[a]);e(t[a].children)}}(this.stateData.threadAry[r.threadIndex].stateAry);var e=n[0].outputAry;e||(e=[],n[0].outputAry=e),e.push({lineId:r.lineData.lineId})}},relateLine2endState:function(r){if(r.lineData.endState&&null!==r.lineData.endState.stateIndex){var n=[];!function e(t){for(var a in t){if(t[a].stateId===r.lineData.endState.stateId)return void n.push(t[a]);e(t[a].children)}}(this.stateData.threadAry[r.threadIndex].stateAry);var e=n[0].inputAry;e||(e=[],n[0].inputAry=e),e.push({lineId:r.lineData.lineId})}},resizeThread:function(e){e.dh&&(this.stateData.threadAry[e.threadIndex].height+=e.dh),e.dw&&(this.stateData.threadAry[e.threadIndex].width+=e.dw)},getState:function(t,e,a){var r,n;return(n=a?this.stateData.threadAry.find(function(e){return e.id===t}):this.stateData.threadAry[t])&&(r=this.getStateImplement(e,n.stateAry)),r||console.error("根据threadIdOrIndex和stateId获取状态失败---\x3e threadId: "+t+" stateId: "+e+" isThreadId: "+a),r},getStateImplement:function(t,e){var a,r=this;return e.forEach(function(e){if(e.stateId===t)return a=e,!1;e.children&&e.children.length&&(a=r.getStateImplement(t,e.children))}),a}},_router.default.beforeEach(function(e,t,a){console.log(e),("blockly"===t.name&&"state"===e.name||"blockly"===e.name&&"state"===t.name)&&console.log("同步数据... "),a()}),window.EventObj=new _vue.default,new _vue.default({el:"#app",router:_router.default,components:{App:_App.default},template:"<App/>"});
//# sourceMappingURL=main.min.js.map
