{"version":3,"sources":["qblock.js"],"names":["QBlock","store","window","Thread","State","getXY2Canvas","state","threadIndex","threadPos","document","getElementsByClassName","getBoundingClientRect","statePos","Util","getDomByStateId","stateId","x","left","y","top","getStateHeight","translatePX2Num","height","getStateWidth","width","Line","getStartPoint","line","startPoint","isNaN","startState","getState","getEndPoint","endPoint","endState","xy"],"mappings":";;;;;;;AAAA;;;;AACA,IAAIA,MAAM,GAAG;AACTC,EAAAA,KAAK,EAAEC,MAAM,CAACD,KADL;AAETE,EAAAA,MAAM,EAAE,EAFC;AAKTC,EAAAA,KAAK,EAAE;AACH;;;;AAIAC,IAAAA,YALG,wBAKUC,KALV,EAKiBC,WALjB,EAK6B;AAC5B,UAAIC,SAAS,GAAGC,QAAQ,CAACC,sBAAT,CAAgC,QAAhC,EAA0CH,WAA1C,EAAuDI,qBAAvD,EAAhB;;AACA,UAAIC,QAAQ,GAAGC,iBAAKC,eAAL,CAAqBR,KAAK,CAACS,OAA3B,EAAoCJ,qBAApC,EAAf;;AACA,aAAO;AACHK,QAAAA,CAAC,EAAEJ,QAAQ,CAACK,IAAT,GAAgBT,SAAS,CAACS,IAD1B;AAEHC,QAAAA,CAAC,EAAEN,QAAQ,CAACO,GAAT,GAAeX,SAAS,CAACW;AAFzB,OAAP;AAIH,KAZE;AAaHC,IAAAA,cAbG,0BAaYd,KAbZ,EAakB;AACjB,aAAOO,iBAAKQ,eAAL,CAAqBf,KAAK,CAACgB,MAA3B,CAAP;AACH,KAfE;AAgBHC,IAAAA,aAhBG,yBAgBWjB,KAhBX,EAgBiB;AAChB,aAAOO,iBAAKQ,eAAL,CAAqBf,KAAK,CAACkB,KAA3B,CAAP;AACH;AAlBE,GALE;AAyBTC,EAAAA,IAAI,EAAE;AACFC,IAAAA,aADE,yBACYC,IADZ,EACkBpB,WADlB,EAC8B;AAC5B,UACI,CAACoB,IAAI,CAACC,UAAN,IACAD,IAAI,CAACC,UAAL,CAAgBZ,CAAhB,KAAsB,IADtB,IAEA,OAAOW,IAAI,CAACC,UAAL,CAAgBZ,CAAvB,KAA6B,WAF7B,IAGAa,KAAK,CAACF,IAAI,CAACC,UAAL,CAAgBZ,CAAjB,CAJT,EAKE;AACE,YAAIc,UAAU,GAAG7B,KAAK,CAAC8B,QAAN,CAAexB,WAAf,EAA4BoB,IAAI,CAACG,UAAL,CAAgBf,OAA5C,EAAqD;AAAK;AAA1D,SAAjB;AACAY,QAAAA,IAAI,CAACC,UAAL,GAAkB;AACd;AACAZ,UAAAA,CAAC,EAAEc,UAAU,CAACd,CAAX,GAAeH,iBAAKQ,eAAL,CAAqBS,UAAU,CAACN,KAAhC,CAFJ;AAGdN,UAAAA,CAAC,EAAEY,UAAU,CAACZ,CAAX,GAAeL,iBAAKQ,eAAL,CAAqBS,UAAU,CAACR,MAAhC,IAA0C;AAH9C,SAAlB;AAKH;;AACD,aAAOK,IAAI,CAACC,UAAZ;AACH,KAhBC;AAiBFI,IAAAA,WAjBE,uBAiBUL,IAjBV,EAiBgBpB,WAjBhB,EAiB6B;AAC3B;AACA,UACI,CAACoB,IAAI,CAACM,QAAN,IACAN,IAAI,CAACM,QAAL,CAAcjB,CAAd,KAAoB,IADpB,IAEA,OAAOW,IAAI,CAACM,QAAL,CAAcjB,CAArB,KAA2B,WAF3B,IAGAa,KAAK,CAACF,IAAI,CAACM,QAAL,CAAcjB,CAAf,CAJT,EAKE;AACE,YAAIkB,SAAQ,GAAGjC,KAAK,CAAC8B,QAAN,CAAexB,WAAf,EAA4BoB,IAAI,CAACO,QAAL,CAAcnB,OAA1C,EAAmD;AAAK;AAAxD,SAAf;;AACA,YAAIoB,GAAE,GAAGnC,MAAM,CAACI,KAAP,CAAaC,YAAb,CAA0B6B,SAA1B,EAAoC3B,WAApC,CAAT;AACA;;;;;;;AAKAoB,QAAAA,IAAI,CAACM,QAAL,GAAgB;AACZjB,UAAAA,CAAC,EAAEmB,GAAE,CAACnB,CADM;AAEZE,UAAAA,CAAC,EAAEiB,GAAE,CAACjB,CAAH,GAAOL,iBAAKQ,eAAL,CAAqBa,SAAQ,CAACZ,MAA9B,IAAwC;AAFtC,SAAhB;AAIH;;AACD,UAAIY,QAAQ,GAAGjC,KAAK,CAAC8B,QAAN,CAAexB,WAAf,EAA4BoB,IAAI,CAACO,QAAL,CAAcnB,OAA1C,EAAmD;AAAK;AAAxD,OAAf;AACA,UAAIoB,EAAE,GAAGnC,MAAM,CAACI,KAAP,CAAaC,YAAb,CAA0B6B,QAA1B,EAAoC3B,WAApC,CAAT;AACA;;;;;;AAKAoB,MAAAA,IAAI,CAACM,QAAL,GAAgB;AACZjB,QAAAA,CAAC,EAAEmB,EAAE,CAACnB,CADM;AAEZE,QAAAA,CAAC,EAAEiB,EAAE,CAACjB,CAAH,GAAOL,iBAAKQ,eAAL,CAAqBa,QAAQ,CAACZ,MAA9B,IAAwC;AAFtC,OAAhB;AAIA,aAAOK,IAAI,CAACM,QAAZ;AACH;AAjDC;AAzBG,CAAb;eA6EejC,M","sourcesContent":["import Util from './util.js'\r\nvar QBlock = {\r\n    store: window.store,\r\n    Thread: {\r\n\r\n    },\r\n    State: {\r\n        /**\r\n         * 获取状态相对于线程框的坐标信息\r\n         * @param {*} state\r\n         */\r\n        getXY2Canvas(state, threadIndex){\r\n            let threadPos = document.getElementsByClassName(\"thread\")[threadIndex].getBoundingClientRect();\r\n            let statePos = Util.getDomByStateId(state.stateId).getBoundingClientRect();\r\n            return {\r\n                x: statePos.left - threadPos.left,\r\n                y: statePos.top - threadPos.top\r\n            }\r\n        },\r\n        getStateHeight(state){\r\n            return Util.translatePX2Num(state.height);\r\n        },\r\n        getStateWidth(state){\r\n            return Util.translatePX2Num(state.width);\r\n        }\r\n    },\r\n    Line: {\r\n        getStartPoint(line, threadIndex){\r\n            if (\r\n                !line.startPoint ||\r\n                line.startPoint.x === null ||\r\n                typeof line.startPoint.x === \"undefined\" ||\r\n                isNaN(line.startPoint.x)\r\n            ) {\r\n                let startState = store.getState(threadIndex, line.startState.stateId, false/**isThreadId: false */);\r\n                line.startPoint = {\r\n                    //TODO 需改用getXY2Canvas更准确\r\n                    x: startState.x + Util.translatePX2Num(startState.width),\r\n                    y: startState.y + Util.translatePX2Num(startState.height) / 2,\r\n                };\r\n            }\r\n            return line.startPoint;\r\n        },\r\n        getEndPoint(line, threadIndex) {\r\n            //如果结束点不存在\r\n            if (\r\n                !line.endPoint ||\r\n                line.endPoint.x === null ||\r\n                typeof line.endPoint.x === \"undefined\" ||\r\n                isNaN(line.endPoint.x)\r\n            ) {\r\n                let endState = store.getState(threadIndex, line.endState.stateId, false/**isThreadId: false */);\r\n                let xy = QBlock.State.getXY2Canvas(endState, threadIndex);\r\n                /* line.endPoint = {\r\n                    //TODO 需改用getXY2Canvas更准确\r\n                    x: endState.x,\r\n                    y: endState.y + Util.translatePX2Num(endState.height) / 2,\r\n                }; */\r\n                line.endPoint = {\r\n                    x: xy.x,\r\n                    y: xy.y + Util.translatePX2Num(endState.height) / 2,\r\n                };\r\n            }\r\n            let endState = store.getState(threadIndex, line.endState.stateId, false/**isThreadId: false */);\r\n            let xy = QBlock.State.getXY2Canvas(endState, threadIndex);\r\n            /* line.endPoint = {\r\n                //TODO 需改用getXY2Canvas更准确\r\n                x: endState.x,\r\n                y: endState.y + Util.translatePX2Num(endState.height) / 2,\r\n            }; */\r\n            line.endPoint = {\r\n                x: xy.x,\r\n                y: xy.y + Util.translatePX2Num(endState.height) / 2,\r\n            };\r\n            return line.endPoint;\r\n        },\r\n    }\r\n}\r\nexport default QBlock;"],"file":"qblock.dev.js"}